USE inventory;
GO

CREATE TABLE Employee (
    Username VARCHAR(50) PRIMARY KEY,
    Password VARCHAR(100),
    Role VARCHAR(50),
);
GO

--1. NhaCungCap (Suppliers) - Manual Primary Key Input
CREATE TABLE Suppliers (
    SupplierID VARCHAR(50) PRIMARY KEY,
    SupplierName NVARCHAR(255),
    Addr NVARCHAR(255),
    PhoneNumber VARCHAR(20),
    Email VARCHAR(255)
);
GO

--2. Loại Sản Phẩm (Product Categories) - Manual Primary Key Input
CREATE TABLE ProductCategories (
    CategoryID VARCHAR(50) PRIMARY KEY,
    CategoryName NVARCHAR(255) NOT NULL
);
GO

--3. Kho (Warehouses) - Manual Primary Key Input
CREATE TABLE Warehouses (
    WarehouseID VARCHAR(50) PRIMARY KEY,
    WarehouseName NVARCHAR(255),
    Addr NVARCHAR(255)
);
GO

--4. KhachHang (Customers) - Manual Primary Key Input
CREATE TABLE Customers (
    CustomerID VARCHAR(50) PRIMARY KEY,
    CustomerName NVARCHAR(255),
    Addr NVARCHAR(255),
    Email VARCHAR(255),
    PhoneNumber VARCHAR(20)
);
GO

--5. Nhân Viên (Employees) - Auto-generated Primary Key
CREATE TABLE Employees (
    EmployeeID VARCHAR(50) PRIMARY KEY DEFAULT (CONVERT(VARCHAR(50), NEWID())), -- Auto-generated if not provided
    EmployeeName NVARCHAR(255),
    DateOfBirth DATE,
    Gender NVARCHAR(10),
    Addr NVARCHAR(200),
    Email VARCHAR(255),
    PhoneNumber VARCHAR(20)
);
GO

--6. Sản Phẩm (Products) - Custom Primary Key Generation Required
CREATE TABLE Products (
    ProductID VARCHAR(50) PRIMARY KEY, -- ProductID will be generated by application logic (e.g., CategoryID + SequentialNumber)
    ProductName NVARCHAR(255),
    Description NVARCHAR(MAX), -- 'Decs' likely means 'Description'
    UnitOfMeasure NVARCHAR(50),
    ImportPrice DECIMAL(18, 2),
    SellingPrice DECIMAL(18, 2),
    SupplierID VARCHAR(50) NULL,
    CategoryID VARCHAR(50),
    IsActive BIT DEFAULT 1, 
    FOREIGN KEY (SupplierID) REFERENCES Suppliers(SupplierID),
    FOREIGN KEY (CategoryID) REFERENCES ProductCategories(CategoryID)
);
GO

--7. Phiếu Nhập Kho (Inbound Orders / Goods Receipts) - Auto-generated Primary Key
CREATE TABLE InboundOrders (
    InboundOrderID VARCHAR(50) PRIMARY KEY DEFAULT (CONVERT(VARCHAR(50), NEWID())), -- Auto-generated if not provided
    SupplierID VARCHAR(50),
    EmployeeID VARCHAR(50),
    DateOfReceipt DATETIME,
    TotalAmount DECIMAL(18, 2),
    Notes NVARCHAR(MAX),
    FOREIGN KEY (SupplierID) REFERENCES Suppliers(SupplierID),
    FOREIGN KEY (EmployeeID) REFERENCES Employees(EmployeeID)
);
GO

--8. Phiếu Xuất Kho (Outbound Orders / Goods Issues) - Auto-generated Primary Key
CREATE TABLE OutboundOrders (
    OutboundOrderID VARCHAR(50) PRIMARY KEY DEFAULT (CONVERT(VARCHAR(50), NEWID())), -- Auto-generated if not provided
    CustomerID VARCHAR(50),
    EmployeeID VARCHAR(50),
    DispatchDate DATETIME,
    TotalAmount DECIMAL(18, 2),
    Notes NVARCHAR(MAX),
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID),
    FOREIGN KEY (EmployeeID) REFERENCES Employees(EmployeeID)
);
GO

--9. Chi Tiết Phiếu Nhập Kho (Inbound Order Details) - Auto-generated Primary Key (Identity)
CREATE TABLE InboundOrderDetails (

    InboundDetailID INT PRIMARY KEY IDENTITY(1,1),
    InboundOrderID VARCHAR(50),
    ProductID VARCHAR(50),
    WarehouseID VARCHAR(50),
    QuantityReceived INT,
    UnitPrice DECIMAL(18, 2),
    LineTotal DECIMAL(18, 2),
    FOREIGN KEY (InboundOrderID) REFERENCES InboundOrders(InboundOrderID),
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID),
    FOREIGN KEY (WarehouseID) REFERENCES Warehouses(WarehouseID)
);
GO

--10. Chi Tiết Phiếu Xuất Kho (Outbound Order Details) - Auto-generated Primary Key (Identity)
CREATE TABLE OutboundOrderDetails (
    OutboundDetailID INT PRIMARY KEY IDENTITY(1,1),
    OutboundOrderID VARCHAR(50),
    ProductID VARCHAR(50),
    WarehouseID VARCHAR(50),
    UnitPrice DECIMAL(18, 2),
    QuantityDispatched INT,
    LineTotal DECIMAL(18, 2),
    FOREIGN KEY (OutboundOrderID) REFERENCES OutboundOrders(OutboundOrderID),
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID),
    FOREIGN KEY (WarehouseID) REFERENCES Warehouses(WarehouseID)
);
GO

--11. Hàng trong kho (Inventory / StockInWarehouse)
CREATE TABLE Inventory (
    ProductID VARCHAR(50),
    WarehouseID VARCHAR(50),
    Quantity INT,
    PRIMARY KEY (ProductID, WarehouseID),
    FOREIGN KEY (ProductID) REFERENCES Products(ProductID),
    FOREIGN KEY (WarehouseID) REFERENCES Warehouses(WarehouseID)
);
GO

-- Chèn dữ liệu cho bảng Loại Sản Phẩm (ProductCategories)
INSERT INTO ProductCategories (CategoryID, CategoryName) VALUES
('ELE', N'Electronics'),
('HOU', N'Housewares'),
('MSC', N'Miscellaneous');
GO

-- Chèn dữ liệu cho bảng Nhà Cung Cấp (Suppliers)
INSERT INTO Suppliers (SupplierID, SupplierName, Addr, PhoneNumber, Email) VALUES
('SUP001', N'Công Ty TNHH ABC', N'123 Đường Giải Phóng, Hà Nội', '0901234567', 'contact@abc.com'),
('SUP002', N'Doanh Nghiệp Tư Nhân XYZ', N'456 Đường Lê Lợi, TP. Hồ Chí Minh', '0987654321', 'info@xyz.vn'),
('SUP003', N'Tập Đoàn Toàn Cầu JSC', N'789 Đường Nguyễn Huệ, Đà Nẵng', '0912345678', 'support@toancau.com');
GO

-- Chèn dữ liệu cho bảng Kho (Warehouses)
-- Dữ liệu kho không được cung cấp đầy đủ trong ảnh, tạm thời tạo một kho để đảm bảo tính toàn vẹn dữ liệu
INSERT INTO Warehouses (WarehouseID, WarehouseName, Addr) VALUES
('WH001', N'Kho Tổng hợp 1', N'Địa chỉ kho mặc định');
GO

-- Chèn dữ liệu cho bảng Sản Phẩm (Products)
INSERT INTO Products (ProductID, ProductName, Description, UnitOfMeasure, ImportPrice, SellingPrice, SupplierID, CategoryID, IsActive) VALUES
('ELE001', N'nam12', NULL, NULL, 3.00, 2.00, 'SUP001', 'ELE', 1),
('ELE002', N'duy', N'Điện thoại thông minh với camera 108MP', N'Cái', 9500000.00, 12500000.00, 'SUP001', 'ELE', 1),
('ELE003', N'Tai nghe Bluetooth Z', N'Tai nghe không dây, chống ồn chủ động', N'Cái', 1200000.00, 1800000.00, 'SUP002', 'ELE', 1),
('ELE004', N'nam', N'test', N'hộp', 13.00, 12.00, NULL, 'ELE', 1),
('HOU001', N'Bộ Nồi Inox Cao Cấp abc', N'Bộ 5 nồi inox 304, nắp kính chịu lực', N'Bộ', 2500000.00, 3500000.00, 'SUP002', 'HOU', 1),
('HOU002', N'Máy Xay Sinh Tố Đa Năng', N'Xay hoa quả, thịt, hạt khô', N'Cái', 800000.00, 1200000.00, 'SUP002', 'HOU', 1),
('MSC001', N'Sách Kỹ Năng Mềm', N'Tuyển tập các bài học phát triển bản thân', N'Quyển', 150000.00, 220000.00, NULL, 'MSC', 1),
('MSC002', N'Bút Bi Xóa Được', N'Bút bi mực xanh, có thể xóa được', N'Cây', 20000.00, 35000.00, NULL, 'MSC', 1);
GO

-- Chèn dữ liệu cho bảng Hàng trong kho (Inventory)
INSERT INTO Inventory (ProductID, WarehouseID, Quantity) VALUES
('ELE001', 'WH001', 0),
('ELE002', 'WH001', 123),
('ELE003', 'WH001', 300),
('ELE004', 'WH001', 0),
('HOU001', 'WH001', 75),
('HOU002', 'WH001', 120),
('MSC001', 'WH001', 500),
('MSC002', 'WH001', 1000);
GO